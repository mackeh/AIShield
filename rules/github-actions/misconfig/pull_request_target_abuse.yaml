id: AISHIELD-GHA-MISCONFIG-001
title: Dangerous PR Head Checkout
severity: critical
confidence_that_ai_generated: 0.95
languages: [github-actions]
category: misconfig
ai_tendency: AI assistants often suggest checking out `pull_request.head.sha` to fix "code not found" errors in `pull_request_target` workflows, inadvertently exposing the repo to RCE.
pattern:
  contains:
    - "github.event.pull_request.head.sha"
negative_patterns:
  - "# secure-workflow"
fix:
  suggestion: Do not check out the PR head in a `pull_request_target` workflow. This gives untrusted code access to repository secrets. Use `on: pull_request` instead.
tags: [github-actions, ci-cd, injection, owasp-top10]
cwe_id: CWE-74
owasp_category: A03:2021 - Injection
