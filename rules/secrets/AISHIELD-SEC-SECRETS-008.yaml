id: AISHIELD-SEC-SECRETS-008
title: Generic API Key Assignment
severity: high
confidence_that_ai_generated: 0.90
languages: [python, javascript, go, rust, java, csharp, ruby, php, kotlin, swift]
category: secrets
cwe_id: CWE-798
owasp_category: "A07:2021 - Identification and Authentication Failures"
ai_tendency: AI assistants frequently generate code with hardcoded API keys using common prefixes like sk- or key- instead of reading from environment or config.
pattern:
  all:
    - "api_key"
    - "="
  any:
    - "\"sk-"
    - "'sk-"
    - "\"key-"
    - "'key-"
  not:
    - "os.environ"
    - "process.env"
    - "env::"
    - "getenv"
fix:
  suggestion: Read API keys from environment variables (e.g., os.environ, process.env) or a secrets manager. Never assign API key literals in source code.
tags: [secrets, api-key, credentials, generic]
