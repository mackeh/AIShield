id: AISHIELD-K8S-MISC-013
title: Secret Value Hardcoded in Environment Variable
severity: high
confidence_that_ai_generated: 0.81
languages: [kubernetes]
category: misconfig
cwe_id: CWE-798
owasp_category: A07:2021 - Identification and Authentication Failures
ai_tendency: AI-generated manifests often inline secret values in env.value instead of referencing Secret objects.
pattern:
  all:
    - "name: password"
    - "value:"
  not:
    - "secretkeyref"
fix:
  suggestion: Store secrets in a Kubernetes Secret and reference via env.valueFrom.secretKeyRef.
tags: [kubernetes, secrets, misconfig]
