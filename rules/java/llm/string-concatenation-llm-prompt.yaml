id: AISHIELD-JAVA-LLM-001
title: String Concatenation in LLM Prompt
severity: critical
confidence_that_ai_generated: 0.84
languages: [java]
category: llm
cwe_id: CWE-77
owasp_category: A03:2021 - Injection
ai_tendency: AI-generated Java code frequently uses String.format or + concatenation to embed user input directly into LLM prompts.
pattern:
  any:
    - "string.format"
    - "+ user"
    - "+ input"
    - "+user"
    - "+input"
  all:
    - "prompt"
  not:
    - "// sanitized"
    - "// validated"
fix:
  suggestion: Use structured prompt builders with input validation and sanitization. Separate user input from system instructions using the messages API role boundaries. Apply input length limits and character filtering.
tags: [llm, prompt-injection, string-concatenation]
