id: AISHIELD-DOCKER-MISC-015
title: ARG Instruction with Default Secret Value
severity: high
confidence_that_ai_generated: 0.79
languages: [dockerfile]
category: misconfig
cwe_id: CWE-798
owasp_category: A07:2021 - Identification and Authentication Failures
ai_tendency: AI-generated Dockerfiles may set default ARG values for tokens or passwords that persist in image history.
pattern:
  all:
    - "arg "
    - "token"
    - "="
fix:
  suggestion: Never set default values for secrets in ARG. Use Docker build secrets (--mount=type=secret) instead.
tags: [dockerfile, secrets, arg, misconfig]
